<div class="row">
  <div id="dashboard" class="col-xs-12">
    
    <% if @paid_vacation != nil then %>
    <h4>&nbsp;&nbsp;<%= @paid_vacation.year %><small>年度</small></h4><br/>

    <div id="flick">
      <ul>
      
      <!-- ページ数はdashboard.css.scssの$pagesで指定
        ページ数は偶数にすること。奇数ページだと１ページあたりのwidth計算で端数がでるためうまくいかない -->
      
      <!-- 1ページ -->
      <li>
        <%= render 'remain' %>
      </li>
    
      <!-- 2ページ -->
      <li>
        <%= render 'detail' %>
      </li>
    
      </ul>

    </div><!-- flick -->
   <% end %>

    <!-- ページインジケーター -->
    <div id="indicator"><%= image_tag "indicator.png", :size => "13x5", :alt => "" %></div>

  </div>
</div>



<!-- フリック動作用JavaScript -->
<script type="text/javascript">
(function(){
	var fl = $('#flick');
	var indelm = $('#indicator');
	var indimg = indelm.find('img');

	fl.flickSimple({
		snap: 'first',
		onResize: function() {
			// update indicator
			indelm.css( { width: (this.pageLength * 13) + 'px' } );
		},
		onChange: function() {
			// move indicator
			var pos = (this.page -1) * 13;
			if ( this.android || ! this.webkit ) {
				indimg.css( { left: pos +'px' } );
			} else {
				indimg.css( { webkitTransform:'translate3d('+ pos +'px,0,0)' } );
			}
		},
		onClick: function(elm) {
			elm.fadeOut('fast').fadeIn('fast').fadeOut('fast').fadeIn('fast');
		}
	});

})();
</script>



<div class="row">
  <div class="col-xs-12">

    <!-- 追加ボタン -->
    <div class="row">
      <div class="col-xs-4 col-xs-offset-8 text-right">
        <a href="<%= new_vacation_path + "?user_id=" + @user.id.to_s + "&callback_url=" + request.original_url%>" class="btn btn-primary btn-lg"><span class="glyphicon glyphicon-plus"</span></a><br />
        <br />
      </div>
    </div>
    
    <!-- 消化有休リスト -->
    <div class="row">
      <div class="col-xs-12">
        <table class="table table-striped table-hover">
          <% youbi = %w[日 月 火 水 木 金 土] %>
          <% month = 0 %>
          <% @vacations.each do |vacation| %>
          <tr>
            <!-- 月/日 曜日 -->
            <td>
              <div style="white-space: nowrap;">
                <div class="vacation month">
                  <% if month != vacation.start_datetime.strftime("%m").to_i %>
                    <% month = vacation.start_datetime.strftime("%m").to_i %>
                    <%= month %> /
                  <% else %>
                     
                  <% end %>
                </div>
                <div class="vacation date">
                  <strong><%= vacation.start_datetime.strftime("%d").to_i %></strong>
                </div>
                <div class="vacation weekday">
                  <%= youbi[vacation.start_datetime.wday] + "" %>
                </div>
              </div>
            </td>
            <!-- 消化時間 -->
            <td>
              <div>
                <%= vacation.hours %>
              </div>
            </td>
            <!-- 時刻 -->
            <td>
              <div class="hidden-xs" style="white-space: nowrap;">
                <div class="vacation hour">
                  <%= vacation.start_datetime.strftime("%H").to_i %>
                </div><%= vacation.start_datetime.strftime(":%M") %>
                  -
                <div class="vacation hour">
                  <%= vacation.end_datetime.strftime("%H").to_i %>
                </div><%= vacation.end_datetime.strftime(":%M") %>
              </div>
            </td>
            <!-- メモ -->
            <td>
              <div class="vacation memo">
                <%= vacation.memo %>
              </div>
            </td>
            <!-- 確定 -->
            <td>
              <div class="hidden-xs">
                <%= vacation.fixed %>
              </div>    
            </td>
            <!-- 編集画面リンク -->
            <td class="text-right"><a href="<%= edit_vacation_path(vacation.id.to_s) + "?callback_url=" + request.original_url%>" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-pencil"></span></a></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>

  </div>
</div>
