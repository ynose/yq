<div class="row">
  <div id="dashboard" class="col-xs-12">
    
    <% if @paid_vacation != nil then %>
    <h4>&nbsp;&nbsp;<%= @paid_vacation.year %><small>年度</small></h4><br/>

    <div id="flick">
      <ul>
      
      <!-- 2ページ -->
      <li>
        <div class="row">
          <div class="col-xs-12" style="padding: 0 40px 0 40px">
            <div class="row">
            
              <div class="col-xs-1">
                <div class="col-xs-12" style="background-color: blue, height: <%= @vacationHourOfMonth[4] %>px"></div>
                <%= sprintf("%g", @vacationHourOfMonth[4]) if @vacationHourOfMonth[4] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[5] if @vacationHourOfMonth[5] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[6] if @vacationHourOfMonth[6] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[7] if @vacationHourOfMonth[7] > 0 %>
              </div>
              <div class="col-xs-1">
              <div class="row">
                <div class="col-xs-12" style="vertical-align: bottom;">
                  <%= sprintf("%g", @vacationHourOfMonth[9]) if @vacationHourOfMonth[9] > 0 %>
                </div>
                <div class="col-xs-12" style="vertical-align: bottom;">
                  <%= sprintf("%g", @vacationHourOfMonth[9]) if @vacationHourOfMonth[9] > 0 %>
                </div>
                <div class="col-xs-12" style="display: block; background-color: #0000f0; height: <%= @vacationHourOfMonth[8] %>px">
                </div>
              </div>
              </div>
              <div class="col-xs-1">
              <div class="row">
                <div class="col-xs-12" style="vertical-align: bottom;">
                  <%= sprintf("%g", @vacationHourOfMonth[9]) if @vacationHourOfMonth[9] > 0 %>
                </div>
                <div class="col-xs-12" style="vertical-align: bottom;">
                  <%= sprintf("%g", @vacationHourOfMonth[9]) if @vacationHourOfMonth[9] > 0 %>
                </div>
                <div class="col-xs-12" style="vertical-align: bottom; background-color: #0000f0; height: <%= @vacationHourOfMonth[9] %>px">
                </div>
              </div>
              </div>
              <div class="col-xs-1" style="vertical-align: bottom;">
                <%= sprintf("%g", @vacationHourOfMonth[10]) if @vacationHourOfMonth[10] > 0 %>
                <div class="col-xs-12" style="display: block; background-color: #0000f0; height: <%= @vacationHourOfMonth[10] %>px">
                </div>                
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[11] if @vacationHourOfMonth[11] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[12] if @vacationHourOfMonth[12] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[1] if @vacationHourOfMonth[1] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[2] if @vacationHourOfMonth[2] > 0 %>
              </div>
              <div class="col-xs-1">
                <%= @vacationHourOfMonth[3] if @vacationHourOfMonth[3] > 0 %>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-1">
                4
              </div>
              <div class="col-xs-1">
                5
              </div>
              <div class="col-xs-1">
                6
              </div>
              <div class="col-xs-1">
                7
              </div>
              <div class="col-xs-1">
                8
              </div>
              <div class="col-xs-1">
                9
              </div>
              <div class="col-xs-1">
                10
              </div>
              <div class="col-xs-1">
                11
              </div>
              <div class="col-xs-1">
                12
              </div>
              <div class="col-xs-1">
                1
              </div>
              <div class="col-xs-1">
                2
              </div>
              <div class="col-xs-1">
                3
              </div>
            </div>
          </div>
        </div>
      </li>  
  
      
      <!-- 1ページ -->
      <li>
        <!-- のこり表示 -->
        <div class="row">
          <div class="col-xs-12">
 
            <% paid_vacation_total_hours = @paid_vacation.hours + @paid_vacation.carryover_hours %>
        
            <!-- のこり日数(時間を日数に換算) -->
            <h4 class="text-center">のこり</h4>
            <h1 class="text-center">
              &nbsp;&nbsp;<strong><%= ((paid_vacation_total_hours - @vacation_total_hours) / 8).to_i %></strong><small>日</small>
            </h1>
            
            <!-- のこり時間 -->
            <h5 class="text-center">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= paid_vacation_total_hours - @vacation_total_hours %><small>時間</small>
            </h5>
            <br/>
            <br/>
        
            <!-- プログレスバー -->
            <div class="row">
        
                <div class="col-xs-9 col-xs-offset-1">
                  
                  <div class="progress">
                    <!-- 消化率 -->
                    <% percent = (@vacation_total_hours / paid_vacation_total_hours) * 100 %>
                    <div class="progress-bar" role="progressbar" aria-valuenow="<%= percent %>" aria-valuemin="0" aria-valuemax="100" style="width: <%= percent %>%;">
                      <!-- 消化日数表示 -->
                      <%= (@vacation_total_hours / 8).ceil %><small>日</small>
                    </div>
                  </div>
                  
                </div>
                <div class="col-xs-1" style="padding-left: 0">
                  <!-- 支給日数表示 -->
                  <nobr><%= (paid_vacation_total_hours / 8).to_i %><small>日</small></nobr>
                </div>
        
            </div>
        
          </div>
        </div>
      </li>
    
      <!-- 3ページ -->
      <li>
        <!-- 詳細表示 -->
        <div class="row">
          <div class="col-xs-6 col-xs-offset-2">
            <%= @user.id %>
            <%= @user.name %>
            <%= @user.email %>
            <br />
            <br />
            <% if @paid_vacation != nil then %>
            支給: <%= @paid_vacation.hours %><small>時間</small><br/>
            繰り越し: <%= @paid_vacation.carryover_hours %><small>時間</small><br/>
            合計: <%= @paid_vacation.hours + @paid_vacation.carryover_hours %><small>時間</small><br/>
            <br/>
            消化: <%= @vacation_total_hours %><small>時間</small><br/>
            残り: <%= @paid_vacation.hours + @paid_vacation.carryover_hours - @vacation_total_hours %><small>時間</small> (<%= (@paid_vacation.hours + @paid_vacation.carryover_hours - @vacation_total_hours) / 8 %><small>日</small>)
            <br/>
            <% end %>
          </div>    
        </div>
      
      </li>

      <!-- 4ページ -->
      <li>
        <div class="row">
          <div class="col-xs-12">
          &nbsp;&nbsp;4page
          </div>
        </div>
      </li>  
  
    
      </ul>

    </div><!-- flick -->
   <% end %>

    <!-- ページインジケーター -->
    <div id="indicator"><%= image_tag "indicator.png", :size => "13x5", :alt => "" %></div>

  </div>
</div>



<!-- フリック動作用JavaScript -->
<script type="text/javascript">
(function(){
	var fl = $('#flick');
	var indelm = $('#indicator');
	var indimg = indelm.find('img');

	fl.flickSimple({
		snap: 'first',
		onResize: function() {
			// update indicator
			indelm.css( { width: (this.pageLength * 13) + 'px' } );
		},
		onChange: function() {
			// move indicator
			var pos = (this.page -1) * 13;
			if ( this.android || ! this.webkit ) {
				indimg.css( { left: pos +'px' } );
			} else {
				indimg.css( { webkitTransform:'translate3d('+ pos +'px,0,0)' } );
			}
		},
		onClick: function(elm) {
			elm.fadeOut('fast').fadeIn('fast').fadeOut('fast').fadeIn('fast');
		}
	});

})();
</script>



<div class="row">
  <div class="col-xs-12">

    <!-- 追加ボタン -->
    <div class="row">
      <div class="col-xs-4 col-xs-offset-8 text-right">
        <a href="<%= new_vacation_path + "?user_id=" + @user.id.to_s + "&callback_url=" + request.original_url%>" class="btn btn-primary btn-lg"><span class="glyphicon glyphicon-plus"</span></a><br />
        <br />
      </div>
    </div>
    
    <!-- 消化有休リスト -->
    <div class="row">
      <div class="col-xs-12">
        <table class="table table-striped table-hover">
          <% youbi = %w[日 月 火 水 木 金 土] %>
          <% month = 0 %>
          <% @vacations.each do |vacation| %>
          <tr>
            <!-- 月/日 曜日 -->
            <td>
              <div style="white-space: nowrap;">
                <div class="vacation month">
                  <% if month != vacation.start_datetime.strftime("%m").to_i %>
                    <% month = vacation.start_datetime.strftime("%m").to_i %>
                    <%= month %> /
                  <% else %>
                     
                  <% end %>
                </div>
                <div class="vacation date">
                  <strong><%= vacation.start_datetime.strftime("%d").to_i %></strong>
                </div>
                <div class="vacation weekday">
                  <%= youbi[vacation.start_datetime.wday] + "" %>
                </div>
              </div>
            </td>
            <!-- 消化時間 -->
            <td>
              <div>
                <%= vacation.hours %>
              </div>
            </td>
            <!-- 時刻 -->
            <td>
              <div class="hidden-xs" style="white-space: nowrap;">
                <div class="vacation hour">
                  <%= vacation.start_datetime.strftime("%H").to_i %>
                </div><%= vacation.start_datetime.strftime(":%M") %>
                  -
                <div class="vacation hour">
                  <%= vacation.end_datetime.strftime("%H").to_i %>
                </div><%= vacation.end_datetime.strftime(":%M") %>
              </div>
            </td>
            <!-- メモ -->
            <td>
              <div class="vacation memo">
                <%= vacation.memo %>
              </div>
            </td>
            <!-- 確定 -->
            <td>
              <div class="hidden-xs">
                <%= vacation.fixed %>
              </div>    
            </td>
            <!-- 編集画面リンク -->
            <td><a href="<%= edit_vacation_path(vacation.id.to_s) + "?callback_url=" + request.original_url%>"><span class="glyphicon glyphicon-cog"></span></a></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>

  </div>
</div>
